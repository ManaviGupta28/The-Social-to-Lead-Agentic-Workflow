2026-01-11 20:16:45.138215: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-11 20:16:54.611181: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
Traceback (most recent call last):
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\activations_tf.py", line 22, in <module>
    import tf_keras as keras
ModuleNotFoundError: No module named 'tf_keras'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Manavi Gupta\Downloads\rag\test_retrieval.py", line 2, in <module>
    from rag.retriever import get_retriever
  File "C:\Users\Manavi Gupta\Downloads\rag\rag\retriever.py", line 22, in <module>
    from langchain_text_splitters import RecursiveCharacterTextSplitter
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_text_splitters\__init__.py", line 38, in <module>
    from langchain_text_splitters.sentence_transformers import (
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_text_splitters\sentence_transformers.py", line 11, in <module>
    from sentence_transformers import (  # type: ignore[import-not-found, unused-ignore]
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\__init__.py", line 15, in <module>
    from sentence_transformers.cross_encoder import (
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\cross_encoder\__init__.py", line 3, in <module>
    from .CrossEncoder import CrossEncoder
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\cross_encoder\CrossEncoder.py", line 35, in <module>
    from sentence_transformers.cross_encoder.fit_mixin import FitMixin
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\cross_encoder\fit_mixin.py", line 20, in <module>
    from sentence_transformers.datasets.NoDuplicatesDataLoader import NoDuplicatesDataLoader
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\datasets\__init__.py", line 13, in <module>
    from .ParallelSentencesDataset import ParallelSentencesDataset
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\datasets\ParallelSentencesDataset.py", line 19, in <module>
    from sentence_transformers import SentenceTransformer
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\SentenceTransformer.py", line 36, in <module>
    from sentence_transformers.model_card import SentenceTransformerModelCardData, generate_model_card
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\model_card.py", line 26, in <module>
    from transformers.integrations import CodeCarbonCallback
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 2317, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 2347, in _get_module
    raise e
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 2345, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\integrations\integration_utils.py", line 60, in <module>
    from .. import TFPreTrainedModel
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 2317, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 2347, in _get_module
    raise e
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 2345, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\modeling_tf_utils.py", line 38, in <module>
    from .activations_tf import get_tf_activation
  File "C:\Users\Manavi Gupta\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\activations_tf.py", line 27, in <module>
    raise ValueError(
ValueError: Your currently installed version of Keras is Keras 3, but this is not yet supported in Transformers. Please install the backwards-compatible tf-keras package with `pip install tf-keras`.
